#!/usr/bin/runghc

import Control.Monad
import System.Directory

main = do
    undodir <- getXdgDirectory XdgData "nvim/undo"
    withCurrentDirectory undodir
      (listDirectory "."
        >>= filterM (fmap not . doesFileExist . replace)
        >>= mapM removeFile)
  where replace = map (\c -> if c == '%' then '/' else c)

-- vi: ft=haskell
