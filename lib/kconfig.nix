{ lib, ... }:
{ config, cpuManufacturer }:

with lib.kernel;

let
  mkIf = cond: if cond then yes else no;
in
rec {
  # Fallout patches are those that were only used to unset options that became
  # unused or conflicted with the calculated sets

  # There is some attempt to make patches either addition or subtraction since
  # this helps merging.

  # separating out choices that every kernel should have
  base = [
    no-debug
    no-fun
    cpu-specific
    no-old
    no-rare
    no-sec
    no-unused-crypto
    small
    swap
    user-friendly
    zram
    zswap
  ];

  # This set is for the additive workflow, building up from tinyconfig
  # ⚠️ NOT YET WORKING
  addition = [
    streamlined

    peripherals-usb # stub for common usb
    peripherals-misc # stub for common other
    peripherals-video # stub for external monitors

    # Subtract unused options added by NixOS
    localmod-unused-net-vendors
    localmod-unused-snd
    localmod-unused-video
  ];

  # Subtraction strategy, starting from defconfig and NixOS defaults, reduced
  # with localmodconfig.
  subtract = [

    localmod-unused-drm
    localmod-unused-gpio
    localmod-unused-ir
    localmod-unused-media
    localmod-unused-net-vendors
    localmod-unused-regulators
    localmod-unused-rtc
    localmod-unused-sensors
    localmod-unused-snd
    localmod-unused-video
    localmod-unused-wifi

    # Cleaning up dependent settings.  These can change depending on changes to
    # other patches.  It is annoying to keep them in sync, and it is a good idea
    # to keep them together.
    subtract-fallout
  ];

  # It must be noted that kernel configuration, with a tree menu for
  # something like 4k options, is not user friendly ;-)
  user-friendly = {
    # Give us the config back at /proc/config.gz so we can modify it!
    # On by default, just pointing it out
    IKCONFIG = yes;
    IKCONFIG_PROC = yes;

    IKHEADERS = unset;

    # Leniant
    # Complain, but don't fail.  This option makes a lot of
    # sense because not every module will even be run and
    # even if we suspect a module might be broken, unless
    # we are kernel devs, we generally will take the risk
    # that it works.
    # WERROR = no;

    # Generally this one will save you from problems because the wrapped clang
    # compiler generates a lot of warnings... and then fails ;-)
    # CC_NO_UNUSED_ARGS_WARNINGS = yes;

    # Haven't found a need for this, but could come in handy
    # SECTION_MISMATCH_WARN_ONLY = yes;
  };

  not-vm = {
    KVM = no;
    KVM_GUEST = unset;
    MOUSE_PS2_VMMOUSE = unset;
    # XEN = unset;
    HYPERV = unset;
    PARAVIRT_TIME_ACCOUNTING = unset;
    HYPERVISOR_GUEST = no;

    # fallout
    DRM_HYPERV = unset;
    TDX_GUEST_DRIVER = unset;
  };

  swap.SWAP = mkIf (config.zramSwap.enable || config.swapDevices != [ ]);

  zram =
    let
      backend = lib.toUpper (lib.removeSuffix "-rle" config.zramSwap.algorithm);
    in
    {
      ZRAM = mkIf config.zramSwap.enable;
      ZRAM_BACKEND_LZ4 = no;
      ZRAM_BACKEND_LZ4HC = no;
      ZRAM_BACKEND_DEFLATE = no;
      ZRAM_BACKEND_842 = no;
      ZRAM_BACKEND_LZO = no;
      ZRAM_BACKEND_ZSTD = no;
      ZRAM_MEMORY_TRACKING = yes;
      ZRAM_TRACK_ENTRY_ACTIME = yes;
    }
    // {
      "ZRAM_BACKEND_${backend}" = lib.mkOverride 99 yes;
    };

  zswap = {
    ZSWAP = mkIf (lib.elem "zswap.enabled=1" config.boot.kernelParams);
    ZSWAP_COMPRESSOR_DEFAULT = "zstd";
    ZSWAP_COMPRESSOR_DEFAULT_ZSTD = yes;
    ZSWAP_DEFAULT_ON = yes;
  };

  cpu-specific = {
    CPU_SUP_AMD = no;
    CPU_SUP_CENTAUR = no;
    CPU_SUP_HYGON = no;
    CPU_SUP_INTEL = yes;
    CPU_SUP_ZHAOXIN = no;
    PROCESSOR_SELECT = yes;
  }
  // {
    "CPU_SUP_${lib.toUpper cpuManufacturer}" = lib.mkOverride 99 yes;
  };

  bluetooth = {
    BT_HIDP = mkIf config.hardware.bluetooth.enable;
    BT_RFCOMM = mkIf config.hardware.bluetooth.enable;
    BT_BNEP = mkIf config.hardware.bluetooth.enable;
  };

  no-old = {
    AMD_NUMA = no; # superseeded by X86_64_ACPI_NUMA
    ARCNET = no; # superseeded by Ethernet and Wifi
    ATALK = no; # AppleTalk
    FB_VESA = no; # Vesa 2.0 graphics
    FDDI = no; # superseeded by Ethernet and Wifi
    ISO9660_FS = no; # CD ROM
    MTD = no; # to work with flash memory
    PARPORT = no; # parallel port
    PLIP = no; # Parallel Line Internet Protocol
    SLIP = no; # Serial Line Internet Protocol
    USB_OHCI_HCD = no; # for USB 1.1
    USB_UHCI_HCD = no; # for USB 1.1
    X86_16BIT = no; # 16-bit code segments
    X86_ACPI_CPUFREQ_CPB = no; # for old AMD CPUs
    X86_POWERNOW_K8 = no; # for old AMD CPUs
  };

  realtek = {
    # TODO
    RTLWIFI = unset;
    RTLWIFI_PCI = unset;
  };

  no-rare-hardware = {
    # USB_GSPCA = no; # GSPCA-based webcams
    OLPC = unset; # One Laptop per Child
    DVB = no; # digital TV tuner cards
    RADIO_ADAPTERS = no;
    RAPIDIO = no;
    HID_GYRATION = no; # gyroscopes
    HID_SUNPLUS = no; # Sunplus devices
    SURFACE_PLATFORMS = no; # Microsoft Surface
    MACINTOSH_DRIVERS = no;
    INFINIBAND = no;
    ATM = no; # Asynchronous Transfer Mode
    # IIO = no;
    SPEAKUP = no; # text-to-speach
    # TINYDRM = no; # already unset <-- HERE
    RC_LOOPBACK = no;
    RC_ATI_REMOTE = no;
    RC_XBOX_DVD = no;

    # said to be for testing only
    RCU_REF_SCALE_TEST = no;
    SCF_TORTURE_TEST = no;
    TEST_LOCKUP = no;
    TEST_POWER = no;
    THERMAL_CORE_TESTING = no;

    X86_EXTENDED_PLATFORM = no;

    CPU_SUP_HYGON = unset;
    CPU_SUP_CENTAUR = unset;
    CPU_SUP_ZHAOXIN = unset;
  };

  no-fun = {
    INPUT_MISC = no;
    INPUT_TOUCHSCREEN = no;
    INPUT_TABLET = no;
    INPUT_JOYSTICK = no; # :-(
  };

  no-sec = {
    # We are not a k8s server
    CPU_MITIGATIONS = no;
    SECURITY_SELINUX = no;
    SECURITY_APPARMOR = no;
    DEFAULT_SECURITY_APPARMOR = unset;
  };

  no-unused-crypto = {
    CRYPTO_842 = no;
    CRYPTO_LZ4 = no;
    CRYPTO_LZ4HC = no;
    CRYPTO_BLOWFISH = no;
    CRYPTO_BLOWFISH_X86_64 = no;
    CRYPTO_DES = no;
    CRYPTO_FCRYPT = no;
    CRYPTO_KHAZAD = no;
    CRYPTO_ANUBIS = no;
    # Seem to have some dependents that need disabling
    # CRYPTO_CAMELLIA = no;
    # CRYPTO_SERPENT = no;
    CRYPTO_TEA = no;
    CRYPTO_TWOFISH = no;
  };

  # ⚠️ This is a result of running the streamline perl script.  It likely will not
  # pass config, but is left as an example of the output!
  streamlined = {
    "64BIT" = yes;
    ADVISE_SYSCALLS = yes;
    AIO = yes;
    ALLOW_DEV_COREDUMP = yes;
    ARCH_CLOCKSOURCE_INIT = yes;
    ARCH_CONFIGURES_CPU_MITIGATIONS = yes;
    ARCH_CORRECT_STACKTRACE_ON_KRETPROBE = yes;
    ARCH_DEFAULT_CRASH_DUMP = yes;
    ARCH_DMA_ADDR_T_64BIT = yes;
    ARCH_ENABLE_MEMORY_HOTPLUG = yes;
    ARCH_ENABLE_SPLIT_PMD_PTLOCK = yes;
    ARCH_HAS_ADD_PAGES = yes;
    ARCH_HAS_CACHE_LINE_SIZE = yes;
    ARCH_HAS_COPY_MC = yes;
    ARCH_HAS_CPU_CACHE_INVALIDATE_MEMREGION = yes;
    ARCH_HAS_CPU_FINALIZE_INIT = yes;
    ARCH_HAS_CPU_RELAX = yes;
    ARCH_HAS_CRC32 = yes;
    ARCH_HAS_CRC64 = yes;
    ARCH_HAS_CRC_T10DIF = yes;
    ARCH_HAS_CURRENT_STACK_POINTER = yes;
    ARCH_HAS_DEBUG_VIRTUAL = yes;
    ARCH_HAS_DEBUG_VM_PGTABLE = yes;
    ARCH_HAS_DEBUG_WX = yes;
    ARCH_HAS_DEVMEM_IS_ALLOWED = yes;
    ARCH_HAS_ELFCORE_COMPAT = yes;
    ARCH_HAS_ELF_RANDOMIZE = yes;
    ARCH_HAS_FAST_MULTIPLIER = yes;
    ARCH_HAS_FORTIFY_SOURCE = yes;
    ARCH_HAS_GCOV_PROFILE_ALL = yes;
    ARCH_HAS_GIGANTIC_PAGE = yes;
    ARCH_HAS_HW_PTE_YOUNG = yes;
    ARCH_HAS_KCOV = yes;
    ARCH_HAS_KERNEL_FPU_SUPPORT = yes;
    ARCH_HAS_MEMBARRIER_SYNC_CORE = yes;
    ARCH_HAS_MEM_ENCRYPT = yes;
    ARCH_HAS_NMI_SAFE_THIS_CPU_OPS = yes;
    ARCH_HAS_NONLEAF_PMD_YOUNG = yes;
    ARCH_HAS_NON_OVERLAPPING_ADDRESS_SPACE = yes;
    ARCH_HAS_PARANOID_L1D_FLUSH = yes;
    ARCH_HAS_PMEM_API = yes;
    ARCH_HAS_PREEMPT_LAZY = yes;
    ARCH_HAS_PTDUMP = yes;
    ARCH_HAS_PTE_DEVMAP = yes;
    ARCH_HAS_PTE_SPECIAL = yes;
    ARCH_HAS_SET_DIRECT_MAP = yes;
    ARCH_HAS_SET_MEMORY = yes;
    ARCH_HAS_STRICT_KERNEL_RWX = yes;
    ARCH_HAS_STRICT_MODULE_RWX = yes;
    ARCH_HAS_SYNC_CORE_BEFORE_USERMODE = yes;
    ARCH_HAS_SYSCALL_WRAPPER = yes;
    ARCH_HAS_UACCESS_FLUSHCACHE = yes;
    ARCH_HAS_UBSAN = yes;
    ARCH_HAVE_EXTRA_ELF_NOTES = yes;
    ARCH_HAVE_NMI_SAFE_CMPXCHG = yes;
    ARCH_HIBERNATION_POSSIBLE = yes;
    ARCH_MAY_HAVE_PC_FDC = yes;
    ARCH_MHP_MEMMAP_ON_MEMORY_ENABLE = yes;
    ARCH_MIGHT_HAVE_PC_PARPORT = yes;
    ARCH_MIGHT_HAVE_PC_SERIO = yes;
    ARCH_SPARSEMEM_DEFAULT = yes;
    ARCH_SPARSEMEM_ENABLE = yes;
    ARCH_STACKWALK = yes;
    ARCH_SUPPORTS_ACPI = yes;
    ARCH_SUPPORTS_ATOMIC_RMW = yes;
    ARCH_SUPPORTS_AUTOFDO_CLANG = yes;
    ARCH_SUPPORTS_CFI_CLANG = yes;
    ARCH_SUPPORTS_CRASH_DUMP = yes;
    ARCH_SUPPORTS_CRASH_HOTPLUG = yes;
    ARCH_SUPPORTS_DEBUG_PAGEALLOC = yes;
    ARCH_SUPPORTS_INT128 = yes;
    ARCH_SUPPORTS_KEXEC = yes;
    ARCH_SUPPORTS_KEXEC_BZIMAGE_VERIFY_SIG = yes;
    ARCH_SUPPORTS_KEXEC_FILE = yes;
    ARCH_SUPPORTS_KEXEC_HANDOVER = yes;
    ARCH_SUPPORTS_KEXEC_JUMP = yes;
    ARCH_SUPPORTS_KEXEC_PURGATORY = yes;
    ARCH_SUPPORTS_KEXEC_SIG = yes;
    ARCH_SUPPORTS_KEXEC_SIG_FORCE = yes;
    ARCH_SUPPORTS_KMAP_LOCAL_FORCE_MAP = yes;
    ARCH_SUPPORTS_LTO_CLANG = yes;
    ARCH_SUPPORTS_LTO_CLANG_THIN = yes;
    ARCH_SUPPORTS_MSEAL_SYSTEM_MAPPINGS = yes;
    ARCH_SUPPORTS_NUMA_BALANCING = yes;
    ARCH_SUPPORTS_PAGE_TABLE_CHECK = yes;
    ARCH_SUPPORTS_PER_VMA_LOCK = yes;
    ARCH_SUPPORTS_PROPELLER_CLANG = yes;
    ARCH_SUPPORTS_PT_RECLAIM = yes;
    ARCH_SUPPORTS_RT = yes;
    ARCH_SUPPORTS_UPROBES = yes;
    ARCH_SUSPEND_POSSIBLE = yes;
    ARCH_USES_PG_ARCH_2 = yes;
    ARCH_USE_BUILTIN_BSWAP = yes;
    ARCH_USE_CMPXCHG_LOCKREF = yes;
    ARCH_USE_MEMTEST = yes;
    ARCH_USE_QUEUED_RWLOCKS = yes;
    ARCH_USE_QUEUED_SPINLOCKS = yes;
    ARCH_USE_SYM_ANNOTATIONS = yes;
    ARCH_WANTS_DYNAMIC_TASK_STRUCT = yes;
    ARCH_WANTS_NO_INSTR = yes;
    ARCH_WANTS_THP_SWAP = yes;
    ARCH_WANT_BATCHED_UNMAP_TLB_FLUSH = yes;
    ARCH_WANT_DEFAULT_BPF_JIT = yes;
    ARCH_WANT_GENERAL_HUGETLB = yes;
    ARCH_WANT_HUGETLB_VMEMMAP_PREINIT = yes;
    ARCH_WANT_HUGE_PMD_SHARE = yes;
    ARCH_WANT_IRQS_OFF_ACTIVATE_MM = yes;
    ARCH_WANT_LD_ORPHAN_WARN = yes;
    ARCH_WANT_OPTIMIZE_DAX_VMEMMAP = yes;
    ARCH_WANT_OPTIMIZE_HUGETLB_VMEMMAP = yes;
    AS_AVX512 = yes;
    AS_GFNI = yes;
    AS_HAS_NON_CONST_ULEB128 = yes;
    AS_IS_LLVM = yes;
    AS_VAES = yes;
    AS_VPCLMULQDQ = yes;
    AS_WRUSS = yes;
    AUDIT_ARCH = yes;
    BCMA_POSSIBLE = yes;
    BITREVERSE = yes;
    BLOCK = yes;
    BROADCAST_TLB_FLUSH = yes;
    BROKEN_ON_SMP = yes;
    BUG = yes;
    BUILDTIME_TABLE_SORT = yes;
    CACHESTAT_SYSCALL = yes;
    CC_CAN_LINK = yes;
    CC_HAS_ASM_GOTO_OUTPUT = yes;
    CC_HAS_ASM_GOTO_TIED_OUTPUT = yes;
    CC_HAS_ASM_INLINE = yes;
    CC_HAS_AUTO_VAR_INIT_PATTERN = yes;
    CC_HAS_AUTO_VAR_INIT_ZERO = yes;
    CC_HAS_AUTO_VAR_INIT_ZERO_BARE = yes;
    CC_HAS_COUNTED_BY = yes;
    CC_HAS_ENTRY_PADDING = yes;
    CC_HAS_IBT = yes;
    CC_HAS_INT128 = yes;
    CC_HAS_KASAN_GENERIC = yes;
    CC_HAS_KASAN_SW_TAGS = yes;
    CC_HAS_MARCH_NATIVE = yes;
    CC_HAS_NAMED_AS_FIXED_SANITIZERS = yes;
    CC_HAS_NO_PROFILE_FN_ATTR = yes;
    CC_HAS_RANDSTRUCT = yes;
    CC_HAS_RETURN_THUNK = yes;
    CC_HAS_SANE_FUNCTION_ALIGNMENT = yes;
    CC_HAS_SLS = yes;
    CC_HAS_WORKING_NOSANITIZE_ADDRESS = yes;
    CC_HAS_ZERO_CALL_USED_REGS = yes;
    CC_IS_CLANG = yes;
    CC_OPTIMIZE_FOR_PERFORMANCE = yes;
    CLKBLD_I8253 = yes;
    CLKEVT_I8253 = yes;
    CLOCKSOURCE_WATCHDOG = yes;
    CONSOLE_TRANSLATIONS = yes;
    COREDUMP = yes;
    CPU_SUP_AMD = yes;
    CRC32 = yes;
    CRC32_ARCH = yes;
    CRC_OPTIMIZATIONS = yes;
    CRYPTO_ARCH_HAVE_LIB_SHA256 = yes;
    CRYPTO_ARCH_HAVE_LIB_SHA256_SIMD = yes;
    CRYPTO_LIB_BLAKE2S_GENERIC = yes;
    CRYPTO_LIB_SHA256 = yes;
    CRYPTO_LIB_SHA256_GENERIC = yes;
    CRYPTO_SHA256_X86_64 = yes;
    DCACHE_WORD_ACCESS = yes;
    DEBUG_BUGVERBOSE = yes;
    DEBUG_MEMORY_INIT = yes;
    DEFAULT_SECURITY_DAC = yes;
    DMA_NEED_SYNC = yes;
    DMI = yes;
    DMI_SCAN_MACHINE_NON_EFI_FALLBACK = yes;
    DUMMY_CONSOLE = yes;
    DYNAMIC_SIGFRAME = yes;
    EARLY_PRINTK = yes;
    EDAC_ATOMIC_SCRUB = yes;
    EDAC_SUPPORT = yes;
    EFI_PARTITION = yes;
    ELF_CORE = yes;
    EPOLL = yes;
    EVENTFD = yes;
    EXCLUSIVE_SYSTEM_RAM = yes;
    EXPORTFS = yes;
    FHANDLE = yes;
    FILE_LOCKING = yes;
    FIRMWARE_MEMMAP = yes;
    FIX_EARLYCON_MEM = yes;
    FORCE_NR_CPUS = yes;
    FS_IOMAP = yes;
    FUNCTION_ALIGNMENT_16B = yes;
    FUNCTION_ALIGNMENT_4B = yes;
    FUTEX = yes;
    FUTEX_PI = yes;
    FW_LOADER = yes;
    GCC10_NO_ARRAY_BOUNDS = yes;
    GCC_NO_STRINGOP_OVERFLOW = yes;
    GENERIC_BUG = yes;
    GENERIC_BUG_RELATIVE_POINTERS = yes;
    GENERIC_CALIBRATE_DELAY = yes;
    GENERIC_CLOCKEVENTS = yes;
    GENERIC_CLOCKEVENTS_BROADCAST = yes;
    GENERIC_CLOCKEVENTS_BROADCAST_IDLE = yes;
    GENERIC_CLOCKEVENTS_MIN_ADJUST = yes;
    GENERIC_CMOS_UPDATE = yes;
    GENERIC_CPU_AUTOPROBE = yes;
    GENERIC_CPU_DEVICES = yes;
    GENERIC_CPU_VULNERABILITIES = yes;
    GENERIC_EARLY_IOREMAP = yes;
    GENERIC_ENTRY = yes;
    GENERIC_GETTIMEOFDAY = yes;
    GENERIC_IOMAP = yes;
    GENERIC_IRQ_MATRIX_ALLOCATOR = yes;
    GENERIC_IRQ_PROBE = yes;
    GENERIC_IRQ_RESERVATION_MODE = yes;
    GENERIC_IRQ_SHOW = yes;
    GENERIC_ISA_DMA = yes;
    GENERIC_PCI_IOMAP = yes;
    GENERIC_SMP_IDLE_THREAD = yes;
    GENERIC_STRNCPY_FROM_USER = yes;
    GENERIC_STRNLEN_USER = yes;
    GENERIC_TIME_VSYSCALL = yes;
    GENERIC_VDSO_DATA_STORE = yes;
    GENERIC_VDSO_OVERFLOW_PROTECT = yes;
    GENERIC_VDSO_TIME_NS = yes;
    HARDIRQS_SW_RESEND = yes;
    HARDLOCKUP_CHECK_TIMESTAMP = yes;
    HAS_DMA = yes;
    HAS_IOMEM = yes;
    HAS_IOPORT = yes;
    HAS_IOPORT_MAP = yes;
    HAS_LTO_CLANG = yes;
    HAVE_ALIGNED_STRUCT_PAGE = yes;
    HAVE_ARCH_AUDITSYSCALL = yes;
    HAVE_ARCH_HUGE_VMALLOC = yes;
    HAVE_ARCH_HUGE_VMAP = yes;
    HAVE_ARCH_JUMP_LABEL = yes;
    HAVE_ARCH_JUMP_LABEL_RELATIVE = yes;
    HAVE_ARCH_KASAN = yes;
    HAVE_ARCH_KASAN_VMALLOC = yes;
    HAVE_ARCH_KCSAN = yes;
    HAVE_ARCH_KFENCE = yes;
    HAVE_ARCH_KGDB = yes;
    HAVE_ARCH_KMSAN = yes;
    HAVE_ARCH_MMAP_RND_BITS = yes;
    HAVE_ARCH_PREL32_RELOCATIONS = yes;
    HAVE_ARCH_RANDOMIZE_KSTACK_OFFSET = yes;
    HAVE_ARCH_SECCOMP = yes;
    HAVE_ARCH_SECCOMP_FILTER = yes;
    HAVE_ARCH_SOFT_DIRTY = yes;
    HAVE_ARCH_STACKLEAK = yes;
    HAVE_ARCH_THREAD_STRUCT_WHITELIST = yes;
    HAVE_ARCH_TRACEHOOK = yes;
    HAVE_ARCH_TRANSPARENT_HUGEPAGE = yes;
    HAVE_ARCH_TRANSPARENT_HUGEPAGE_PUD = yes;
    HAVE_ARCH_VMAP_STACK = yes;
    HAVE_ARCH_WITHIN_STACK_FRAMES = yes;
    HAVE_ASM_MODVERSIONS = yes;
    HAVE_BUILDTIME_MCOUNT_SORT = yes;
    HAVE_CFI_ICALL_NORMALIZE_INTEGERS_CLANG = yes;
    HAVE_CFI_ICALL_NORMALIZE_INTEGERS_RUSTC = yes;
    HAVE_CMPXCHG_DOUBLE = yes;
    HAVE_CMPXCHG_LOCAL = yes;
    HAVE_CONTEXT_TRACKING_USER = yes;
    HAVE_CONTEXT_TRACKING_USER_OFFSTACK = yes;
    HAVE_C_RECORDMCOUNT = yes;
    HAVE_DEBUG_KMEMLEAK = yes;
    HAVE_DMA_CONTIGUOUS = yes;
    HAVE_DYNAMIC_FTRACE = yes;
    HAVE_DYNAMIC_FTRACE_NO_PATCHABLE = yes;
    HAVE_DYNAMIC_FTRACE_WITH_ARGS = yes;
    HAVE_DYNAMIC_FTRACE_WITH_DIRECT_CALLS = yes;
    HAVE_DYNAMIC_FTRACE_WITH_REGS = yes;
    HAVE_EBPF_JIT = yes;
    HAVE_EFFICIENT_UNALIGNED_ACCESS = yes;
    HAVE_EXIT_THREAD = yes;
    HAVE_FENTRY = yes;
    HAVE_FTRACE_MCOUNT_RECORD = yes;
    HAVE_FTRACE_REGS_HAVING_PT_REGS = yes;
    HAVE_FUNCTION_ARG_ACCESS_API = yes;
    HAVE_FUNCTION_ERROR_INJECTION = yes;
    HAVE_FUNCTION_TRACER = yes;
    HAVE_GCC_PLUGINS = yes;
    HAVE_GENERIC_VDSO = yes;
    HAVE_GUP_FAST = yes;
    HAVE_HARDLOCKUP_DETECTOR_PERF = yes;
    HAVE_HW_BREAKPOINT = yes;
    HAVE_IOREMAP_PROT = yes;
    HAVE_IRQ_EXIT_ON_IRQ_STACK = yes;
    HAVE_IRQ_TIME_ACCOUNTING = yes;
    HAVE_JUMP_LABEL_HACK = yes;
    HAVE_KCSAN_COMPILER = yes;
    HAVE_KERNEL_BZIP2 = yes;
    HAVE_KERNEL_GZIP = yes;
    HAVE_KERNEL_LZ4 = yes;
    HAVE_KERNEL_LZMA = yes;
    HAVE_KERNEL_LZO = yes;
    HAVE_KERNEL_XZ = yes;
    HAVE_KERNEL_ZSTD = yes;
    HAVE_KMSAN_COMPILER = yes;
    HAVE_KPROBES = yes;
    HAVE_KPROBES_ON_FTRACE = yes;
    HAVE_KRETPROBES = yes;
    HAVE_LIVEPATCH = yes;
    HAVE_MIXED_BREAKPOINTS_REGS = yes;
    HAVE_MMIOTRACE_SUPPORT = yes;
    HAVE_MOD_ARCH_SPECIFIC = yes;
    HAVE_MOVE_PMD = yes;
    HAVE_MOVE_PUD = yes;
    HAVE_NMI = yes;
    HAVE_NOINSTR_HACK = yes;
    HAVE_NOINSTR_VALIDATION = yes;
    HAVE_OBJTOOL = yes;
    HAVE_OBJTOOL_MCOUNT = yes;
    HAVE_OBJTOOL_NOP_MCOUNT = yes;
    HAVE_OPTPROBES = yes;
    HAVE_PAGE_SIZE_4KB = yes;
    HAVE_PCI = yes;
    HAVE_PCSPKR_PLATFORM = yes;
    HAVE_PERF_EVENTS = yes;
    HAVE_PERF_EVENTS_NMI = yes;
    HAVE_PERF_REGS = yes;
    HAVE_PERF_USER_STACK_DUMP = yes;
    HAVE_POSIX_CPU_TIMERS_TASK_WORK = yes;
    HAVE_PREEMPT_DYNAMIC = yes;
    HAVE_PREEMPT_DYNAMIC_CALL = yes;
    HAVE_REGS_AND_STACK_ACCESS_API = yes;
    HAVE_RELIABLE_STACKTRACE = yes;
    HAVE_RETHOOK = yes;
    HAVE_RSEQ = yes;
    HAVE_RUST = yes;
    HAVE_SAMPLE_FTRACE_DIRECT = yes;
    HAVE_SAMPLE_FTRACE_DIRECT_MULTI = yes;
    HAVE_SETUP_PER_CPU_AREA = yes;
    HAVE_SOFTIRQ_ON_OWN_STACK = yes;
    HAVE_STACKPROTECTOR = yes;
    HAVE_STACK_VALIDATION = yes;
    HAVE_STATIC_CALL = yes;
    HAVE_STATIC_CALL_INLINE = yes;
    HAVE_SYSCALL_TRACEPOINTS = yes;
    HAVE_UACCESS_VALIDATION = yes;
    HAVE_UNSTABLE_SCHED_CLOCK = yes;
    HAVE_USER_RETURN_NOTIFIER = yes;
    HAVE_VIRT_CPU_ACCOUNTING_GEN = yes;
    HPET_TIMER = yes;
    HZ_250 = yes;
    HZ_PERIODIC = yes;
    I8253_LOCK = yes;
    IA32_FEAT_CTL = yes;
    IKCONFIG = module;
    INIT_STACK_ALL_ZERO = yes;
    INLINE_READ_UNLOCK = yes;
    INLINE_READ_UNLOCK_IRQ = yes;
    INLINE_SPIN_UNLOCK_IRQ = yes;
    INLINE_WRITE_UNLOCK = yes;
    INLINE_WRITE_UNLOCK_IRQ = yes;
    INPUT = yes;
    INSTRUCTION_DECODER = yes;
    IO_DELAY_0X80 = yes;
    IO_URING = yes;
    IO_WQ = yes;
    IRQ_DOMAIN = yes;
    IRQ_DOMAIN_HIERARCHY = yes;
    IRQ_FORCED_THREADING = yes;
    IRQ_WORK = yes;
    ISA_DMA_API = yes;
    KALLSYMS = yes;
    KERNEL_GZIP = yes;
    KERNFS = yes;
    LD_IS_LLD = yes;
    LD_ORPHAN_WARN = yes;
    LEGACY_VSYSCALL_XONLY = yes;
    LOCKDEP_SUPPORT = yes;
    LOCK_DEBUGGING_SUPPORT = yes;
    LOCK_MM_AND_FIND_VMA = yes;
    LTO_NONE = yes;
    MEMBARRIER = yes;
    MICROCODE = yes;
    MMU = yes;
    MMU_GATHER_MERGE_VMAS = yes;
    MMU_GATHER_RCU_TABLE_FREE = yes;
    MMU_GATHER_TABLE_FREE = yes;
    MMU_LAZY_TLB_REFCOUNT = yes;
    MODIFY_LDT_SYSCALL = yes;
    MODULES_USE_ELF_RELA = yes;
    MSDOS_PARTITION = yes;
    MTRR = yes;
    MULTIUSER = yes;
    NAMESPACES = yes;
    NEED_DMA_MAP_STATE = yes;
    NEED_PER_CPU_EMBED_FIRST_CHUNK = yes;
    NEED_PER_CPU_KM = yes;
    NEED_PER_CPU_PAGE_FIRST_CHUNK = yes;
    NEED_SG_DMA_LENGTH = yes;
    OBJTOOL = yes;
    PAGE_MAPCOUNT = yes;
    PAGE_SIZE_4KB = yes;
    PAGE_SIZE_LESS_THAN_256KB = yes;
    PAGE_SIZE_LESS_THAN_64KB = yes;
    PCSPKR_PLATFORM = yes;
    PERF_EVENTS = yes;
    PHYS_ADDR_T_64BIT = yes;
    POSIX_CPU_TIMERS_TASK_WORK = yes;
    POSIX_TIMERS = yes;
    PREEMPT_NONE = yes;
    PREEMPT_NONE_BUILD = yes;
    PRINTK = yes;
    PROC_FS = yes;
    PROC_MEM_ALWAYS_FORCE = yes;
    PROC_PAGE_MONITOR = yes;
    PROC_PID_ARCH_STATUS = yes;
    PROC_SYSCTL = yes;
    PTP_1588_CLOCK_OPTIONAL = yes;
    RANDOMIZE_KSTACK_OFFSET = yes;
    RANDSTRUCT_NONE = yes;
    RSEQ = yes;
    RTC_LIB = yes;
    RTC_MC146818_LIB = yes;
    RT_MUTEXES = yes;
    RUSTC_HAS_COERCE_POINTEE = yes;
    RUSTC_HAS_SPAN_FILE = yes;
    RUSTC_HAS_UNNECESSARY_TRANSMUTES = yes;
    SBITMAP = yes;
    SCSI_MOD = yes;
    SECRETMEM = yes;
    SGETMASK_SYSCALL = yes;
    SHMEM = yes;
    SIGNALFD = yes;
    SLUB = yes;
    SLUB_DEBUG = yes;
    SOFTIRQ_ON_OWN_STACK = yes;
    SPARSEMEM = yes;
    SPARSEMEM_EXTREME = yes;
    SPARSEMEM_VMEMMAP = yes;
    SPARSEMEM_VMEMMAP_ENABLE = yes;
    SPARSE_IRQ = yes;
    SSB_POSSIBLE = yes;
    STACKDEPOT = yes;
    STACKTRACE = yes;
    STACKTRACE_SUPPORT = yes;
    STRICT_KERNEL_RWX = yes;
    SWIOTLB = yes;
    SYSCTL = yes;
    SYSCTL_EXCEPTION_TRACE = yes;
    SYSFS = yes;
    THREAD_INFO_IN_TASK = yes;
    TICK_CPU_ACCOUNTING = yes;
    TIMERFD = yes;
    TINY_RCU = yes;
    TINY_SRCU = yes;
    TOOLS_SUPPORT_RELR = yes;
    TRACE_IRQFLAGS_NMI_SUPPORT = yes;
    TRACE_IRQFLAGS_SUPPORT = yes;
    TRACING_SUPPORT = yes;
    TTY = yes;
    UNIX98_PTYS = yes;
    UNWINDER_ORC = yes;
    UP_LATE_INIT = yes;
    USB_OHCI_LITTLE_ENDIAN = yes;
    USER_STACKTRACE_SUPPORT = yes;
    VDSO_GETRANDOM = yes;
    VGA_CONSOLE = yes;
    VM_EVENT_COUNTERS = yes;
    VT = yes;
    VT_CONSOLE = yes;
    X86 = yes;
    X86_64 = yes;
    X86_CMOV = yes;
    X86_CX8 = yes;
    X86_DEBUGCTLMSR = yes;
    X86_DIRECT_GBPAGES = yes;
    X86_DISABLED_FEATURE_CALL_DEPTH = yes;
    X86_DISABLED_FEATURE_CENTAUR_MCR = yes;
    X86_DISABLED_FEATURE_CYRIX_ARR = yes;
    X86_DISABLED_FEATURE_ENQCMD = yes;
    X86_DISABLED_FEATURE_FRED = yes;
    X86_DISABLED_FEATURE_IBT = yes;
    X86_DISABLED_FEATURE_K6_MTRR = yes;
    X86_DISABLED_FEATURE_LAM = yes;
    X86_DISABLED_FEATURE_OSPKE = yes;
    X86_DISABLED_FEATURE_PKU = yes;
    X86_DISABLED_FEATURE_PTI = yes;
    X86_DISABLED_FEATURE_RETHUNK = yes;
    X86_DISABLED_FEATURE_RETPOLINE = yes;
    X86_DISABLED_FEATURE_RETPOLINE_LFENCE = yes;
    X86_DISABLED_FEATURE_SEV_SNP = yes;
    X86_DISABLED_FEATURE_SGX = yes;
    X86_DISABLED_FEATURE_TDX_GUEST = yes;
    X86_DISABLED_FEATURE_UNRET = yes;
    X86_DISABLED_FEATURE_USER_SHSTK = yes;
    X86_DISABLED_FEATURE_VME = yes;
    X86_DISABLED_FEATURE_XENPV = yes;
    X86_ESPFIX64 = yes;
    X86_HAVE_PAE = yes;
    X86_INTEL_TSX_MODE_OFF = yes;
    X86_IO_APIC = yes;
    X86_LOCAL_APIC = yes;
    X86_MPPARSE = yes;
    X86_PAT = yes;
    X86_REQUIRED_FEATURE_ALWAYS = yes;
    X86_REQUIRED_FEATURE_CMOV = yes;
    X86_REQUIRED_FEATURE_CPUID = yes;
    X86_REQUIRED_FEATURE_CX8 = yes;
    X86_REQUIRED_FEATURE_FPU = yes;
    X86_REQUIRED_FEATURE_FXSR = yes;
    X86_REQUIRED_FEATURE_LM = yes;
    X86_REQUIRED_FEATURE_MSR = yes;
    X86_REQUIRED_FEATURE_NOPL = yes;
    X86_REQUIRED_FEATURE_PAE = yes;
    X86_REQUIRED_FEATURE_PGE = yes;
    X86_REQUIRED_FEATURE_PSE = yes;
    X86_REQUIRED_FEATURE_UP = yes;
    X86_REQUIRED_FEATURE_XMM2 = yes;
    X86_REQUIRED_FEATURE_XMM = yes;
    X86_TSC = yes;
    X86_UMIP = yes;
    X86_VMX_FEATURE_NAMES = yes;
    X86_VSYSCALL_EMULATION = yes;
    ZONE_DMA32 = yes;
    ZONE_DMA = yes;
  };

  peripherals-fallout = {
    IOSCHED_BFQ = module;
  };

  # Options disabled by other options.  This is why we really need to
  # apply options via the kernel infrastructure rather than from
  # structured config.
  subtract-fallout = {
    MAX31827 = no;
    PMBUS = no;
    "9P_FSCACHE" = unset;
    "9P_FS_POSIX_ACL" = unset;
    AX25 = unset;
    BCACHEFS_POSIX_ACL = unset;
    BCACHEFS_QUOTA = unset;
    BTRFS_FS_POSIX_ACL = unset;
    CEPH_FSCACHE = unset;
    CEPH_FS_POSIX_ACL = unset;
    CIFS_DFS_UPCALL = unset;
    CIFS_FSCACHE = unset;
    CIFS_POSIX = unset;
    CIFS_UPCALL = unset;
    CIFS_XATTR = unset;
    DRM_UNSETUVEAU_GSP_DEFAULT = unset;
    DRM_UNSETUVEAU_SVM = unset;
    EXT3_FS_POSIX_ACL = unset;
    EXT3_FS_SECURITY = unset;
    FSCACHE_STATS = unset;
    HVC_XEN = unset;
    HVC_XEN_FRONTEND = unset;
    INFINIBAND_IPOIB = unset;
    INFINIBAND_IPOIB_CM = unset;
    NFSD_V3_ACL = unset;
    NFSD_V4 = unset;
    NFSD_V4_SECURITY_LABEL = unset;
    NFS_FS = unset;
    NFS_FSCACHE = unset;
    NFS_LOCALIO = unset;
    NFS_SWAP = unset;
    NFS_V3_ACL = unset;
    NFS_V4_1 = unset;
    NFS_V4_2 = unset;
    NFS_V4_SECURITY_LABEL = unset;
    OCFS2_DEBUG_MASKLOG = unset;
    POWER_RESET_GPIO = unset;
    POWER_RESET_GPIO_RESTART = unset;
    REISERFS_FS_POSIX_ACL = unset;
    # REISERFS_FS_SECURITY = unset;
    REISERFS_FS_XATTR = unset;
    MITIGATION_SLS = unset;
    DRM_PANIC_SCREEN_QR_CODE = unset;
    CRYPTO_TEST = unset;
    CRC32_SELFTEST = unset;
    RUST = unset;
    PCI_XEN = unset;
    SUNRPC_DEBUG = unset;
    SWIOTLB_XEN = unset;
    XEN_BACKEND = unset;
    XEN_BALLOON = unset;
    XEN_BALLOON_MEMORY_HOTPLUG = unset;
    XEN_DOM0 = unset;
    XEN_EFI = unset;
    XEN_HAVE_PVMMU = unset;
    XEN_MCE_LOG = unset;
    XEN_PVH = unset;
    XEN_PVHVM = unset;
    XEN_SAVE_RESTORE = unset;
    XEN_SYS_HYPERVISOR = unset;
    AIC79XX_DEBUG_ENABLE = unset;
    AIC7XXX_DEBUG_ENABLE = unset;
    AIC94XX_DEBUG = unset;
    MEGARAID_NEWGEN = unset;
    NET_FC = unset;
    SATA_MOBILE_LPM_POLICY = unset;
    SCSI_LOGGING = unset;
    SCSI_LOWLEVEL = unset;
    SCSI_LOWLEVEL_PCMCIA = unset;
    SCSI_SAS_ATA = unset;
    CHROMEOS_LAPTOP = unset;
    CHROMEOS_PSTORE = unset;
    CHROMEOS_TBMC = unset;
    CROS_EC = unset;
    CROS_EC_I2C = unset;
    CROS_EC_ISHTP = unset;
    CROS_EC_LPC = unset;
    CROS_EC_SPI = unset;
    CROS_KBD_LED_BACKLIGHT = unset;
    DRM_EXYNOS = unset;
    DRM_I915_GVT = unset;
    DRM_I915_GVT_KVMGT = unset;
    EXT2_FS_POSIX_ACL = unset;
    EXT2_FS_SECURITY = unset;
    EXT2_FS_XATTR = unset;
    JOYSTICK_PSXPAD_SPI_FF = unset;
    JOYSTICK_XPAD_FF = unset;
    JOYSTICK_XPAD_LEDS = unset;
    "8139TOO_8129" = unset;
    "8139TOO_PIO" = unset;
    XPOWER_PMIC_OPREGION = unset;
    ISA_DMA_API = no;

    NET_VENDOR_CISCO = unset;
    NET_VENDOR_EMULEX = unset;
    SND_SOC_MAX98357A = unset;
    X86_SGX_KVM = unset;

    KVM_AMD_SEV = unset;
    KVM_ASYNC_PF = unset;
    KVM_GENERIC_DIRTYLOG_READ_PROTECT = unset;
    KVM_MMIO = unset;
    KVM_VFIO = unset;

    BT_RFCOMM_TTY = unset;
    DLCI = unset;
    DVB = unset;
    EISA = unset;
    FB_3DFX_ACCEL = unset;
    FB_ATY_CT = unset;
    FB_ATY_GX = unset;
    FB_EFI = unset;
    FB_HYPERV = unset;
    FB_NVIDIA_I2C = unset;
    FB_RIVA_I2C = unset;
    FB_SAVAGE_ACCEL = unset;
    FB_SAVAGE_I2C = unset;
    FB_SIS_300 = unset;
    FB_SIS_315 = unset;
    FB_VESA = unset;
    FRAMEBUFFER_CONSOLE_DEFERRED_TAKEOVER = unset;
    FRAMERELAY = unset;
    I2O = unset;
    IEEE1394 = unset;
    IRDA = unset;
    ISA = unset;
    ISAPNP = unset;
    MTD_COMPLEX_MAPPINGS = unset;
    MTD_TESTS = unset;
    NET_DSA_LEGACY = unset;
    NET_SB1000 = unset;
    NVIDIA_SHIELD_FF = unset;
    OLPC = unset;
    PCI_GO_ANY = unset;
    PLIP = unset;
    PNP = unset;
    SLIP_COMPRESSED = unset;
    SLIP_SMART = unset;
    TR = unset;
    UBIFS_FS_ADVANCED_COMPR = unset;
    VGA_SWITCHEROO = unset;
    VIDEO_V4L1 = unset;
    VME = unset;
    TPS68470_PMIC_OPREGION = unset; # PC Load letter?
  };

  no-debug = {
    DEBUG_ATOMIC_SLEEP = no;
    DEBUG_CGROUP_REF = no;
    DEBUG_DEVRES = no;
    DEBUG_DRIVER = no;
    DEBUG_FORCE_FUNCTION_ALIGN_64B = no;
    DEBUG_FORCE_WEAK_PER_CPU = no;
    DEBUG_FS_ALLOW_NONE = no;
    DEBUG_FS_DISALLOW_MOUNT = no;
    DEBUG_GPIO = no;
    DEBUG_INFO_COMPRESSED_ZLIB = no;
    DEBUG_INFO_DWARF4 = no;
    DEBUG_INFO_DWARF5 = no;
    DEBUG_INFO_NONE = no;
    DEBUG_INFO_REDUCED = no;
    DEBUG_INFO_SPLIT = no;
    DEBUG_IRQFLAGS = no;
    DEBUG_KMAP_LOCAL_FORCE_MAP = no;
    DEBUG_KMEMLEAK = no;
    DEBUG_KOBJECT = no;
    DEBUG_LOCKING_API_SELFTESTS = no;
    DEBUG_LOCK_ALLOC = no;
    DEBUG_MAPLE_TREE = no;
    DEBUG_MUTEXES = no;
    DEBUG_NET = no;
    DEBUG_NET_SMALL_RTNL = no;
    DEBUG_NMI_SELFTEST = no;
    DEBUG_NOTIFIERS = no;
    DEBUG_OBJECTS = no;
    DEBUG_PAGEALLOC = no;
    DEBUG_PAGE_REF = no;
    DEBUG_PERF_USE_VMALLOC = no;
    DEBUG_PER_CPU_MAPS = no;
    DEBUG_PINCTRL = no;
    DEBUG_PLIST = no;
    DEBUG_PREEMPT = no;
    DEBUG_RODATA_TEST = no;
    DEBUG_RSEQ = no;
    DEBUG_RT_MUTEXES = no;
    DEBUG_RWSEMS = no;
    DEBUG_SG = no;
    DEBUG_SHIRQ = no;
    DEBUG_SPINLOCK = no;
    DEBUG_STACK_USAGE = no;
    DEBUG_TEST_DRIVER_REMOVE = no;
    DEBUG_TLBFLUSH = no;
    DEBUG_VFS = no;
    DEBUG_VIRTUAL = no;
    DEBUG_VM = no;
    DEBUG_VM_PGTABLE = no;
    DEBUG_WQ_FORCE_RR_CPU = no;
    DEBUG_WW_MUTEX_SLOWPATH = no;

    X86_MCE_INJECT = no;
  };

  localmod-unused-drm = {
    # Swathes of graphics
    DRM_NOUVEAU = no;
    DRM_NOUVEAU_GSP_DEFAULT = unset;
    DRM_NOUVEAU_SVM = unset;
    DRM_I915 = no;
    DRM_RADEON = no;
  };

  localmod-unused-gpio = {
    GPIB = no;
    GPIO_74X164 = no;
    GPIO_74XX_MMIO = no;
    GPIO_ADNP = no;
    GPIO_AGGREGATOR = no;
    GPIO_ALTERA = no;
    GPIO_AMD8111 = no;
    GPIO_AMDPT = no;
    GPIO_CADENCE = no;
    GPIO_CRYSTAL_COVE = no;
    GPIO_DS4520 = no;
    GPIO_DWAPB = no;
    GPIO_ELKHARTLAKE = no;
    GPIO_F7188X = no;
    GPIO_FTGPIO010 = no;
    GPIO_FXL6408 = no;
    GPIO_GENERIC_PLATFORM = no;
    GPIO_GRANITERAPIDS = no;
    GPIO_GRGPIO = no;
    GPIO_GW_PLD = no;
    GPIO_HLWD = no;
    GPIO_IT87 = no;
    GPIO_LATCH = no;
    GPIO_LOGICVC = no;
    GPIO_MAX3191X = no;
    GPIO_MAX7300 = no;
    GPIO_MAX7301 = no;
    GPIO_MAX732X = no;
    GPIO_MB86S7X = no;
    GPIO_MC33880 = no;
    GPIO_ML_IOH = no;
    GPIO_MOCKUP = no;
    GPIO_MPSSE = no;
    GPIO_PCA953X = no;
    GPIO_PCA9570 = no;
    GPIO_PCF857X = no;
    GPIO_PCIE_IDIO_24 = no;
    GPIO_PCI_IDIO_16 = no;
    GPIO_PISOSR = no;
    GPIO_POLARFIRE_SOC = no;
    GPIO_RDC321X = no;
    GPIO_SCH311X = no;
    GPIO_SIFIVE = no;
    GPIO_SIM = no;
    GPIO_SLOPPY_LOGIC_ANALYZER = no;
    GPIO_SODAVILLE = no;
    GPIO_SYSCON = no;
    GPIO_SYSFS = no;
    GPIO_TPIC2810 = no;
    GPIO_VIRTUSER = no;
    GPIO_VX855 = no;
    GPIO_WATCHDOG = no;
    GPIO_WINBOND = no;
    GPIO_WS16C48 = no;
    GPIO_XILINX = no;
    GPIO_XRA1403 = no;
  };

  localmod-unused-ir = {
    IR_IMON_DECODER = no;
    IR_JVC_DECODER = no;
    IR_MCE_KBD_DECODER = no;
    IR_NEC_DECODER = no;
    IR_RC5_DECODER = no;
    IR_RC6_DECODER = no;
    IR_RCMM_DECODER = no;
    IR_SANYO_DECODER = no;
    IR_SHARP_DECODER = no;
    IR_SONY_DECODER = no;
    IR_XMP_DECODER = no;
    IR_ENE = no;
    IR_FINTEK = no;
    IR_GPIO_CIR = no;
    IR_GPIO_TX = no;
    IR_HIX5HD2 = no;
    IR_IGORPLUGUSB = no;
    IR_IGUANA = no;
    IR_IMON = no;
    IR_IMON_RAW = no;
    IR_ITE_CIR = no;
    IR_MCEUSB = no;
    IR_NUVOTON = no;
    IR_PWM_TX = no;
    IR_REDRAT3 = no;
    IR_SERIAL = no;
    IR_SPI = no;
    IR_STREAMZAP = no;
    IR_TOY = no;
    IR_TTUSBIR = no;
    IR_WINBOND_CIR = no;
  };

  localmod-unused-media = {
    # MEDIA_ANALOG_TV_SUPPORT = no;
    # MEDIA_ATTACH = no;
    # MEDIA_CAMERA_SUPPORT = no;
    MEDIA_CEC_RC = no;
    # MEDIA_CONTROLLER = no;
    # MEDIA_DIGITAL_TV_SUPPORT = no;
    MEDIA_PCI_SUPPORT = no;
    # MEDIA_PLATFORM_DRIVERS = no;
    # MEDIA_PLATFORM_SUPPORT = no;
    # MEDIA_RADIO_SUPPORT = no;
    # MEDIA_SDR_SUPPORT = no;
    # MEDIA_TEST_SUPPORT = no;
    # MEDIA_TUNER = no;
  };

  localmod-unused-net-vendors = {
    # NET_VENDOR_AMD = no;
    # NET_VENDOR_CISCO = no; # Stupid option merging...
    # NET_VENDOR_EMULEX = unset; # Stupid option merging...
    # NET_VENDOR_INTEL = no;  # keep if you have Intel NICs
    # Net vendor can save a tooon of time
    NET_VENDOR_3COM = no;
    NET_VENDOR_ADAPTEC = no;
    NET_VENDOR_ADI = no;
    NET_VENDOR_AGERE = no;
    NET_VENDOR_ALACRITECH = no;
    NET_VENDOR_ALTEON = no;
    NET_VENDOR_AMAZON = no;
    NET_VENDOR_AQUANTIA = no;
    NET_VENDOR_ARC = no;
    NET_VENDOR_ASIX = no;
    NET_VENDOR_ATHEROS = no;
    NET_VENDOR_BROADCOM = no;
    NET_VENDOR_BROCADE = no;
    NET_VENDOR_CADENCE = no;
    NET_VENDOR_CAVIUM = no;
    NET_VENDOR_CHELSIO = no;
    NET_VENDOR_CORTINA = no;
    NET_VENDOR_DAVICOM = no;
    NET_VENDOR_DEC = no;
    NET_VENDOR_DLINK = no;
    NET_VENDOR_ENGLEDER = no;
    NET_VENDOR_EZCHIP = no;
    NET_VENDOR_FUNGIBLE = no;
    NET_VENDOR_GOOGLE = no;
    NET_VENDOR_HISILICON = no;
    NET_VENDOR_HUAWEI = no;
    NET_VENDOR_I825XX = unset;
    NET_VENDOR_INTEL = no;
    NET_VENDOR_LITEX = no;
    NET_VENDOR_MARVELL = no;
    # NET_VENDOR_MELLANOX = no; # TODO wut??
    NET_VENDOR_META = no;
    NET_VENDOR_MICREL = no;
    NET_VENDOR_MICROCHIP = no;
    NET_VENDOR_MICROSEMI = no;
    NET_VENDOR_MICROSOFT = no;
    NET_VENDOR_MYRI = no;
    NET_VENDOR_NATSEMI = no;
    NET_VENDOR_NETERION = no;
    NET_VENDOR_NETRONOME = no;
    NET_VENDOR_NI = no;
    NET_VENDOR_NVIDIA = no;
    NET_VENDOR_OKI = no;
    NET_VENDOR_PACKET_ENGINES = no;
    NET_VENDOR_PENSANDO = no;
    NET_VENDOR_QLOGIC = no;
    NET_VENDOR_QUALCOMM = no;
    NET_VENDOR_RDC = no;
    NET_VENDOR_REALTEK = no;
    NET_VENDOR_RENESAS = no;
    NET_VENDOR_ROCKER = no;
    NET_VENDOR_SAMSUNG = no;
    NET_VENDOR_SEEQ = no;
    NET_VENDOR_SILAN = no;
    NET_VENDOR_SIS = no;
    NET_VENDOR_SMSC = no;
    NET_VENDOR_SOCIONEXT = no;
    NET_VENDOR_SOLARFLARE = no;
    NET_VENDOR_STMICRO = no;
    NET_VENDOR_SUN = no;
    NET_VENDOR_SYNOPSYS = no;
    NET_VENDOR_TEHUTI = no;
    NET_VENDOR_TI = no;
    NET_VENDOR_VERTEXCOM = no;
    NET_VENDOR_VIA = no;
    NET_VENDOR_WANGXUN = no;
    NET_VENDOR_WIZNET = no;
    NET_VENDOR_XILINX = no;
  };

  localmod-unused-regulators = {
    # REGULATOR_FIXED_VOLTAGE = no;
    REGULATOR_88PG86X = no;
    REGULATOR_88PM800 = no;
    REGULATOR_ACT8865 = no;
    REGULATOR_ACT8945A = no;
    REGULATOR_AD5398 = no;
    REGULATOR_ADP5055 = no;
    REGULATOR_ARIZONA_LDO1 = no;
    REGULATOR_ARIZONA_MICSUPP = no;
    REGULATOR_AS3722 = no;
    REGULATOR_ATC260X = no;
    REGULATOR_AW37503 = no;
    REGULATOR_AXP20X = no;
    REGULATOR_BCM590XX = no;
    REGULATOR_BD71815 = no;
    REGULATOR_BD71828 = no;
    REGULATOR_BD718XX = no;
    REGULATOR_BD9571MWV = no;
    REGULATOR_BD957XMUF = no;
    REGULATOR_BD96801 = no;
    REGULATOR_CPCAP = no;
    REGULATOR_CROS_EC = no;
    REGULATOR_DA9062 = no;
    REGULATOR_DA9063 = no;
    REGULATOR_DA9121 = no;
    REGULATOR_DA9210 = no;
    REGULATOR_DA9211 = no;
    REGULATOR_FAN53555 = no;
    REGULATOR_FAN53880 = no;
    REGULATOR_GPIO = no;
    REGULATOR_HI6421 = no;
    REGULATOR_HI6421V530 = no;
    REGULATOR_HI6421V600 = no;
    REGULATOR_ISL6271A = no;
    REGULATOR_ISL9305 = no;
    REGULATOR_LM363X = no;
    REGULATOR_LP3971 = no;
    REGULATOR_LP3972 = no;
    REGULATOR_LP872X = no;
    REGULATOR_LP873X = no;
    REGULATOR_LP8755 = no;
    REGULATOR_LP87565 = no;
    REGULATOR_LTC3589 = no;
    REGULATOR_LTC3676 = no;
    REGULATOR_MAX14577 = no;
    REGULATOR_MAX1586 = no;
    REGULATOR_MAX20086 = no;
    REGULATOR_MAX20411 = no;
    REGULATOR_MAX5970 = no;
    REGULATOR_MAX77503 = no;
    REGULATOR_MAX77541 = no;
    REGULATOR_MAX77620 = no;
    REGULATOR_MAX77650 = no;
    REGULATOR_MAX77686 = no;
    REGULATOR_MAX77693 = no;
    REGULATOR_MAX77802 = no;
    REGULATOR_MAX77826 = no;
    REGULATOR_MAX77857 = no;
    REGULATOR_MAX8649 = no;
    REGULATOR_MAX8660 = no;
    REGULATOR_MAX8893 = no;
    REGULATOR_MAX8907 = no;
    REGULATOR_MAX8952 = no;
    REGULATOR_MAX8973 = no;
    REGULATOR_MC13783 = no;
    REGULATOR_MC13892 = no;
    # REGULATOR_MC13XXX_CORE = no; # unset
    REGULATOR_MCP16502 = no;
    REGULATOR_MP5416 = no;
    REGULATOR_MP8859 = no;
    REGULATOR_MP886X = no;
    REGULATOR_MPQ7920 = no;
    REGULATOR_MT6311 = no;
    REGULATOR_MT6315 = no;
    REGULATOR_MT6323 = no;
    REGULATOR_MT6331 = no;
    REGULATOR_MT6332 = no;
    REGULATOR_MT6357 = no;
    REGULATOR_MT6358 = no;
    REGULATOR_MT6359 = no;
    REGULATOR_MT6360 = no;
    REGULATOR_MT6370 = no;
    REGULATOR_MT6397 = no;
    REGULATOR_PALMAS = no;
    REGULATOR_PCA9450 = no;
    REGULATOR_PF8X00 = no;
    REGULATOR_PF9453 = no;
    REGULATOR_PFUZE100 = no;
    REGULATOR_PV88060 = no;
    REGULATOR_PV88080 = no;
    REGULATOR_PV88090 = no;
    REGULATOR_PWM = no;
    REGULATOR_QCOM_LABIBB = no;
    REGULATOR_QCOM_PM8008 = no;
    REGULATOR_QCOM_SPMI = no;
    REGULATOR_QCOM_USB_VBUS = no;
    REGULATOR_RAA215300 = no;
    REGULATOR_RASPBERRYPI_TOUCHSCREEN_ATTINY = no;
    REGULATOR_RK808 = no;
    REGULATOR_RN5T618 = no;
    # REGULATOR_ROHM = no; # was unset
    REGULATOR_RT4801 = no;
    REGULATOR_RT4803 = no;
    REGULATOR_RT4831 = no;
    REGULATOR_RT5033 = no;
    REGULATOR_RT5120 = no;
    REGULATOR_RT5190A = no;
    REGULATOR_RT5739 = no;
    REGULATOR_RT5759 = no;
    REGULATOR_RT6160 = no;
    REGULATOR_RT6190 = no;
    REGULATOR_RT6245 = no;
    REGULATOR_RTMV20 = no;
    REGULATOR_RTQ2134 = no;
    REGULATOR_RTQ2208 = no;
    REGULATOR_RTQ6752 = no;
    REGULATOR_S2MPA01 = no;
    REGULATOR_S2MPS11 = no;
    REGULATOR_S5M8767 = no;
    REGULATOR_SKY81452 = no;
    REGULATOR_SLG51000 = no;
    REGULATOR_STPMIC1 = no;
    REGULATOR_SY7636A = no;
    REGULATOR_SY8106A = no;
    REGULATOR_SY8824X = no;
    REGULATOR_SY8827N = no;
    REGULATOR_TPS51632 = no;
    REGULATOR_TPS6105X = no;
    REGULATOR_TPS62360 = no;
    REGULATOR_TPS6286X = no;
    REGULATOR_TPS6287X = no;
    REGULATOR_TPS65023 = no;
    REGULATOR_TPS6507X = no;
    REGULATOR_TPS65086 = no;
    REGULATOR_TPS65132 = no;
    REGULATOR_TPS65217 = no;
    REGULATOR_TPS65218 = no;
    REGULATOR_TPS65219 = no;
    REGULATOR_TPS6524X = no;
    REGULATOR_TPS65912 = no;
    REGULATOR_TPS6594 = no;
    # REGULATOR_TPS68470 = no;
    REGULATOR_USERSPACE_CONSUMER = no;
    REGULATOR_VCTRL = no;
    REGULATOR_VIRTUAL_CONSUMER = no;
    REGULATOR_WM8994 = no;
  };

  localmod-unused-rtc = {
    RTC_DRV_TEST = no;
    RTC_DRV_ABB5ZES3 = no;
    RTC_DRV_ABEOZ9 = no;
    RTC_DRV_ABX80X = no;
    RTC_DRV_DS1307 = no;
    RTC_DRV_DS1374 = no;
    RTC_DRV_DS1672 = no;
    RTC_DRV_HYM8563 = no;
    RTC_DRV_MAX6900 = no;
    RTC_DRV_MAX31335 = no;
    RTC_DRV_NCT3018Y = no;
    RTC_DRV_RS5C372 = no;
    RTC_DRV_ISL1208 = no;
    RTC_DRV_ISL12022 = no;
    RTC_DRV_ISL12026 = no;
    RTC_DRV_X1205 = no;
    RTC_DRV_PCF8523 = no;
    RTC_DRV_PCF85063 = no;
    RTC_DRV_PCF85363 = no;
    RTC_DRV_PCF8563 = no;
    RTC_DRV_PCF8583 = no;
    RTC_DRV_M41T80 = no;
    RTC_DRV_BQ32K = no;
    RTC_DRV_S35390A = no;
    RTC_DRV_FM3130 = no;
    RTC_DRV_RX8010 = no;
    RTC_DRV_RX8111 = no;
    RTC_DRV_RX8581 = no;
    RTC_DRV_RX8025 = no;
    RTC_DRV_EM3027 = no;
    RTC_DRV_RV3028 = no;
    RTC_DRV_RV3032 = no;
    RTC_DRV_RV8803 = no;
    RTC_DRV_SD2405AL = no;
    RTC_DRV_SD3078 = no;
    RTC_DRV_M41T93 = no;
    RTC_DRV_M41T94 = no;
    RTC_DRV_DS1302 = no;
    RTC_DRV_DS1305 = no;
    RTC_DRV_DS1343 = no;
    RTC_DRV_DS1347 = no;
    RTC_DRV_DS1390 = no;
    RTC_DRV_MAX6916 = no;
    RTC_DRV_R9701 = no;
    RTC_DRV_RX4581 = no;
    RTC_DRV_RS5C348 = no;
    RTC_DRV_MAX6902 = no;
    RTC_DRV_PCF2123 = no;
    RTC_DRV_MCP795 = no;
    RTC_DRV_DS3232 = no;
    RTC_DRV_PCF2127 = no;
    RTC_DRV_RV3029C2 = no;
    RTC_DRV_RX6110 = no;
    RTC_DRV_DS1286 = no;
    RTC_DRV_DS1511 = no;
    RTC_DRV_DS1553 = no;
    RTC_DRV_DS1685_FAMILY = no;
    RTC_DRV_DS1742 = no;
    RTC_DRV_DS2404 = no;
    RTC_DRV_STK17TA8 = no;
    RTC_DRV_M48T86 = no;
    RTC_DRV_M48T35 = no;
    RTC_DRV_M48T59 = no;
    RTC_DRV_MSM6242 = no;
    RTC_DRV_RP5C01 = no;
    RTC_DRV_ZYNQMP = no;
    RTC_DRV_CADENCE = no;
    RTC_DRV_FTRTC010 = no;
    RTC_DRV_R7301 = no;
    RTC_DRV_GOLDFISH = no;
  };

  localmod-unused-sensors = {
    SENSORS_APDS990X = no;
    SENSORS_BH1770 = no;
    SENSORS_HDAPS = no;
    SENSORS_LIS3_I2C = no;
    SENSORS_TSL2550 = no;
    SENSORS_ABITUGURU = no;
    SENSORS_ABITUGURU3 = no;
    SENSORS_AD7314 = no;
    SENSORS_AD7414 = no;
    SENSORS_AD7418 = no;
    SENSORS_ADM1025 = no;
    SENSORS_ADM1026 = no;
    SENSORS_ADM1029 = no;
    SENSORS_ADM1031 = no;
    SENSORS_ADM1177 = no;
    SENSORS_ADM9240 = no;
    SENSORS_ADT7310 = no;
    SENSORS_ADT7410 = no;
    SENSORS_ADT7411 = no;
    SENSORS_ADT7462 = no;
    SENSORS_ADT7470 = no;
    SENSORS_ADT7475 = no;
    SENSORS_AHT10 = no;
    SENSORS_AQUACOMPUTER_D5NEXT = no;
    SENSORS_AS370 = no;
    SENSORS_ASC7621 = no;
    SENSORS_ASUS_ROG_RYUJIN = no;
    SENSORS_AXI_FAN_CONTROL = no;
    SENSORS_K8TEMP = no;
    SENSORS_FAM15H_POWER = no;
    SENSORS_APPLESMC = no;
    SENSORS_ASB100 = no;
    SENSORS_ATXP1 = no;
    SENSORS_CHIPCAP2 = no;
    SENSORS_CORSAIR_CPRO = no;
    SENSORS_CORSAIR_PSU = no;
    SENSORS_DS620 = no;
    SENSORS_DS1621 = no;
    SENSORS_DELL_SMM = no;
    SENSORS_I5K_AMB = no;
    SENSORS_F71805F = no;
    SENSORS_F71882FG = no;
    SENSORS_F75375S = no;
    SENSORS_FSCHMD = no;
    SENSORS_FTSTEUTATES = no;
    SENSORS_GIGABYTE_WATERFORCE = no;
    SENSORS_GL518SM = no;
    SENSORS_GL520SM = no;
    SENSORS_G760A = no;
    SENSORS_G762 = no;
    SENSORS_GPIO_FAN = no;
    SENSORS_HIH6130 = no;
    SENSORS_HS3001 = no;
    SENSORS_HTU31 = no;
    SENSORS_I5500 = no;
    SENSORS_CORETEMP = no;
    SENSORS_ISL28022 = no;
    SENSORS_IT87 = no;
    SENSORS_JC42 = no;
    SENSORS_POWERZ = no;
    SENSORS_POWR1220 = no;
    SENSORS_LENOVO_EC = no;
    SENSORS_LINEAGE = no;
    SENSORS_LTC2945 = no;
    SENSORS_LTC2947_I2C = no;
    SENSORS_LTC2947_SPI = no;
    SENSORS_LTC2990 = no;
    SENSORS_LTC2991 = no;
    SENSORS_LTC2992 = no;
    SENSORS_LTC4151 = no;
    SENSORS_LTC4215 = no;
    SENSORS_LTC4222 = no;
    SENSORS_LTC4245 = no;
    SENSORS_LTC4260 = no;
    SENSORS_LTC4261 = no;
    SENSORS_LTC4282 = no;
    SENSORS_MAX1111 = no;
    SENSORS_MAX127 = no;
    SENSORS_MAX16065 = no;
    SENSORS_MAX1619 = no;
    SENSORS_MAX1668 = no;
    SENSORS_MAX197 = no;
    SENSORS_MAX31722 = no;
    SENSORS_MAX31730 = no;
    SENSORS_MAX31760 = no;
    SENSORS_MAX6620 = no;
    SENSORS_MAX6621 = no;
    SENSORS_MAX6639 = no;
    SENSORS_MAX6650 = no;
    SENSORS_MAX6697 = no;
    SENSORS_MAX31790 = no;
    SENSORS_MC34VR500 = no;
    SENSORS_MCP3021 = no;
    SENSORS_TC654 = no;
    SENSORS_TPS23861 = no;
    SENSORS_MR75203 = no;
    SENSORS_ADCXX = no;
    SENSORS_LM63 = no;
    SENSORS_LM70 = no;
    SENSORS_LM73 = no;
    SENSORS_LM75 = no;
    SENSORS_LM77 = no;
    SENSORS_LM78 = no;
    SENSORS_LM80 = no;
    SENSORS_LM83 = no;
    SENSORS_LM85 = no;
    SENSORS_LM87 = no;
    SENSORS_LM90 = no;
    SENSORS_LM92 = no;
    SENSORS_LM93 = no;
    SENSORS_LM95234 = no;
    SENSORS_LM95241 = no;
    SENSORS_LM95245 = no;
    SENSORS_PC87360 = no;
    SENSORS_PC87427 = no;
    SENSORS_NCT6683 = no;
    SENSORS_NCT6775 = no;
    SENSORS_NCT6775_I2C = no;
    SENSORS_NCT7363 = no;
    SENSORS_NCT7802 = no;
    SENSORS_NCT7904 = no;
    SENSORS_NPCM7XX = no;
    SENSORS_NZXT_KRAKEN2 = no;
    SENSORS_NZXT_KRAKEN3 = no;
    SENSORS_NZXT_SMART2 = no;
    SENSORS_OCC_P8_I2C = no;
    SENSORS_PCF8591 = no;
    SENSORS_PT5161L = no;
    SENSORS_PWM_FAN = no;
    SENSORS_SBTSI = no;
    SENSORS_SHT15 = no;
    SENSORS_SHT21 = no;
    SENSORS_SHT3x = no;
    SENSORS_SHT4x = no;
    SENSORS_SHTC1 = no;
    SENSORS_SIS5595 = no;
    SENSORS_DME1737 = no;
    SENSORS_EMC1403 = no;
    SENSORS_EMC2103 = no;
    SENSORS_EMC2305 = no;
    SENSORS_EMC6W201 = no;
    SENSORS_SMSC47M1 = no;
    SENSORS_SMSC47M192 = no;
    SENSORS_SMSC47B397 = no;
    SENSORS_SCH5627 = no;
    SENSORS_SCH5636 = no;
    SENSORS_STTS751 = no;
    SENSORS_ADC128D818 = no;
    SENSORS_ADS7828 = no;
    SENSORS_ADS7871 = no;
    SENSORS_AMC6821 = no;
    SENSORS_INA209 = no;
    SENSORS_INA2XX = no;
    SENSORS_INA238 = no;
    SENSORS_INA3221 = no;
    SENSORS_SPD5118 = no;
    SENSORS_TC74 = no;
    SENSORS_THMC50 = no;
    SENSORS_TMP102 = no;
    SENSORS_TMP103 = no;
    SENSORS_TMP108 = no;
    SENSORS_TMP401 = no;
    SENSORS_TMP421 = no;
    SENSORS_TMP464 = no;
    SENSORS_TMP513 = no;
    SENSORS_VIA_CPUTEMP = no;
    SENSORS_VIA686A = no;
    SENSORS_VT1211 = no;
    SENSORS_VT8231 = no;
    SENSORS_W83773G = no;
    SENSORS_W83781D = no;
    SENSORS_W83791D = no;
    SENSORS_W83792D = no;
    SENSORS_W83793 = no;
    SENSORS_W83795 = no;
    SENSORS_W83L785TS = no;
    SENSORS_W83L786NG = no;
    SENSORS_W83627HF = no;
    SENSORS_W83627EHF = no;
    SENSORS_XGENE = no;
    SENSORS_ACPI_POWER = no;
    SENSORS_ATK0110 = no;
    SENSORS_ASUS_WMI = no;
    SENSORS_ASUS_EC = no;
    SENSORS_HP_WMI = no;
  };

  localmod-unused-snd = {
    SND_AD1889 = no;
    SND_ALI5451 = no;
    SND_ALOOP = no;
    SND_ALS300 = no;
    SND_AMD_ASOC_ACP63 = no;
    SND_AMD_ASOC_ACP70 = no;
    SND_AMD_ASOC_REMBRANDT = no;
    SND_AMD_ASOC_RENOIR = no;
    SND_ASIHPI = no;
    SND_ATIIXP = no;
    SND_ATIIXP_MODEM = no;
    SND_ATMEL_SOC = no;
    SND_AU8810 = no;
    SND_AU8820 = no;
    SND_AU8830 = no;
    SND_AUDIO_GRAPH_CARD = no;
    SND_AUDIO_GRAPH_CARD2 = no;
    SND_AW2 = no;
    SND_AZT3328 = no;
    SND_BCD2000 = no;
    SND_BCM63XX_I2S_WHISTLER = no;
    SND_BT87X = no;
    SND_CA0106 = no;
    SND_CMIPCI = no;
    SND_CS4281 = no;
    SND_CS46XX = no;
    SND_CTXFI = no;
    SND_DARLA20 = no;
    SND_DARLA24 = no;
    SND_DESIGNWARE_I2S = no;
    SND_DUMMY = no;
    SND_ECHO3G = no;
    SND_EMU10K1 = no;
    SND_EMU10K1X = no;
    SND_ENS1370 = no;
    SND_ENS1371 = no;
    SND_ES1938 = no;
    SND_ES1968 = no;
    SND_FM801 = no;
    SND_GINA20 = no;
    SND_GINA24 = no;
    SND_HDA_ACPI = no;
    SND_HDA_CODEC_ANALOG = no;
    SND_HDA_CODEC_CA0110 = no;
    SND_HDA_CODEC_CA0132 = no;
    SND_HDA_CODEC_CIRRUS = no;
    SND_HDA_CODEC_CMEDIA = no;
    SND_HDA_CODEC_CONEXANT = no;
    SND_HDA_CODEC_CS8409 = no;
    SND_HDA_CODEC_SENARYTECH = no;
    SND_HDA_CODEC_SI3054 = no;
    SND_HDA_CODEC_SIGMATEL = no;
    SND_HDA_CODEC_VIA = no;
    SND_HDA_SCODEC_CS35L41_I2C = no;
    SND_HDA_SCODEC_CS35L41_SPI = no;
    SND_HDA_SCODEC_CS35L56_I2C = no;
    SND_HDA_SCODEC_CS35L56_SPI = no;
    SND_HDA_SCODEC_TAS2781_I2C = no;
    SND_HDA_SCODEC_TAS2781_SPI = no;
    SND_HDSP = no;
    SND_HDSPM = no;
    SND_I2S_HI6210_I2S = no;
    SND_ICE1712 = no;
    SND_ICE1724 = no;
    SND_INDIGO = no;
    SND_INDIGODJ = no;
    SND_INDIGODJX = no;
    SND_INDIGOIO = no;
    SND_INDIGOIOX = no;
    SND_INTEL8X0 = no;
    SND_INTEL8X0M = no;
    SND_KORG1212 = no;
    SND_LAYLA20 = no;
    SND_LAYLA24 = no;
    SND_LOLA = no;
    SND_LX6464ES = no;
    SND_MAESTRO3 = no;
    SND_MIA = no;
    SND_MIXART = no;
    SND_MIXER_OSS = no;
    SND_MONA = no;
    SND_MPU401 = no;
    SND_MTPAV = no;
    SND_NM256 = no;
    SND_OXYGEN = no;
    SND_PCMTEST = no;
    SND_PCM_OSS = no;
    SND_PCSP = no;
    SND_PCXHR = no;
    SND_RIPTIDE = no;
    SND_RME32 = no;
    SND_RME96 = no;
    SND_RME9652 = no;
    SND_SE6X = no;
    SND_SEQUENCER_OSS = no;
    SND_SERIAL_GENERIC = no;
    SND_SERIAL_U16550 = no;
    SND_SIMPLE_CARD = no;
    SND_SOC_AC97_CODEC = no;
    SND_SOC_ADAU1372_I2C = no;
    SND_SOC_ADAU1372_SPI = no;
    SND_SOC_ADAU1373 = no;
    SND_SOC_ADAU1701 = no;
    SND_SOC_ADAU1761_I2C = no;
    SND_SOC_ADAU1761_SPI = no;
    SND_SOC_ADAU7002 = no;
    SND_SOC_ADAU7118_HW = no;
    SND_SOC_ADAU7118_I2C = no;
    SND_SOC_ADI = no;
    SND_SOC_AK4104 = no;
    SND_SOC_AK4118 = no;
    SND_SOC_AK4375 = no;
    SND_SOC_AK4458 = no;
    SND_SOC_AK4554 = no;
    SND_SOC_AK4613 = no;
    SND_SOC_AK4619 = no;
    SND_SOC_AK4642 = no;
    SND_SOC_AK5386 = no;
    SND_SOC_AK5558 = no;
    SND_SOC_ALC5623 = no;
    SND_SOC_AMD_ACP = no;
    SND_SOC_AMD_LEGACY_MACH = no;
    SND_SOC_AMD_LEGACY_SDW_MACH = no;
    SND_SOC_AMD_PS_MACH = no;
    SND_SOC_AMD_RENOIR_MACH = no;
    SND_SOC_AMD_SOF_MACH = no;
    SND_SOC_AMD_SOF_SDW_MACH = no;
    SND_SOC_AMD_SOUNDWIRE = no;
    SND_SOC_AMD_VANGOGH_MACH = no;
    SND_SOC_AMD_YC_MACH = no;
    SND_SOC_AW8738 = no;
    SND_SOC_AW87390 = no;
    SND_SOC_AW88081 = no;
    SND_SOC_AW88166 = no;
    SND_SOC_AW88261 = no;
    SND_SOC_AW88395 = no;
    SND_SOC_AW88399 = no;
    SND_SOC_BD28623 = no;
    SND_SOC_BT_SCO = no;
    SND_SOC_CHV3_CODEC = no;
    SND_SOC_CHV3_I2S = no;
    SND_SOC_CS35L32 = no;
    SND_SOC_CS35L33 = no;
    SND_SOC_CS35L34 = no;
    SND_SOC_CS35L35 = no;
    SND_SOC_CS35L36 = no;
    SND_SOC_CS35L41_I2C = no;
    SND_SOC_CS35L41_SPI = no;
    SND_SOC_CS35L45_I2C = no;
    SND_SOC_CS35L45_SPI = no;
    SND_SOC_CS35L56_I2C = no;
    SND_SOC_CS35L56_SDW = no;
    SND_SOC_CS35L56_SPI = no;
    SND_SOC_CS4234 = no;
    SND_SOC_CS4265 = no;
    SND_SOC_CS4270 = no;
    SND_SOC_CS4271_I2C = no;
    SND_SOC_CS4271_SPI = no;
    SND_SOC_CS42L42 = no;
    SND_SOC_CS42L42_SDW = no;
    SND_SOC_CS42L51_I2C = no;
    SND_SOC_CS42L52 = no;
    SND_SOC_CS42L56 = no;
    SND_SOC_CS42L73 = no;
    SND_SOC_CS42L83 = no;
    SND_SOC_CS42L84 = no;
    SND_SOC_CS42XX8_I2C = no;
    SND_SOC_CS43130 = no;
    SND_SOC_CS4341 = no;
    SND_SOC_CS4349 = no;
    SND_SOC_CS48L32 = no;
    SND_SOC_CS530X_I2C = no;
    SND_SOC_CS53L30 = no;
    SND_SOC_CX2072X = no;
    SND_SOC_DA7213 = no;
    SND_SOC_DMIC = no;
    SND_SOC_ES7134 = no;
    SND_SOC_ES7241 = no;
    SND_SOC_ES8311 = no;
    SND_SOC_ES8316 = no;
    SND_SOC_ES8323 = no;
    SND_SOC_ES8326 = no;
    SND_SOC_ES8328_I2C = no;
    SND_SOC_ES8328_SPI = no;
    SND_SOC_ES8375 = no;
    SND_SOC_ES8389 = no;
    SND_SOC_FSL_ASRC = no;
    SND_SOC_FSL_AUDMIX = no;
    SND_SOC_FSL_ESAI = no;
    SND_SOC_FSL_MICFIL = no;
    SND_SOC_FSL_SAI = no;
    SND_SOC_FSL_SPDIF = no;
    SND_SOC_FSL_SSI = no;
    SND_SOC_FSL_XCVR = no;
    SND_SOC_GTM601 = no;
    SND_SOC_HDA = no;
    SND_SOC_ICS43432 = no;
    SND_SOC_IDT821034 = no;
    SND_SOC_IMX_AUDMUX = no;
    SND_SOC_INTEL_AVS = no;
    SND_SOC_INTEL_CATPT = no;
    SND_SOC_LPASS_RX_MACRO = no;
    SND_SOC_LPASS_TX_MACRO = no;
    SND_SOC_LPASS_VA_MACRO = no;
    SND_SOC_LPASS_WSA_MACRO = no;
    # SND_SOC_MAX9759 = no; # Stupid option merging
    SND_SOC_MAX98088 = no;
    SND_SOC_MAX98090 = no;
    # SND_SOC_MAX98357A = no; stupid option merging
    SND_SOC_MAX98363 = no;
    SND_SOC_MAX98373_I2C = no;
    SND_SOC_MAX98373_SDW = no;
    SND_SOC_MAX98388 = no;
    SND_SOC_MAX98390 = no;
    SND_SOC_MAX98396 = no;
    SND_SOC_MAX98504 = no;
    SND_SOC_MAX98520 = no;
    SND_SOC_MAX9860 = no;
    SND_SOC_MAX9867 = no;
    SND_SOC_MAX98927 = no;
    SND_SOC_MSM8916_WCD_DIGITAL = no;
    SND_SOC_MT6351 = no;
    SND_SOC_MT6357 = no;
    SND_SOC_MT6358 = no;
    SND_SOC_MT6660 = no;
    SND_SOC_MTK_BTCVSD = no;
    SND_SOC_NAU8315 = no;
    SND_SOC_NAU8540 = no;
    SND_SOC_NAU8810 = no;
    SND_SOC_NAU8821 = no;
    SND_SOC_NAU8822 = no;
    SND_SOC_NAU8824 = no;
    SND_SOC_NTP8835 = no;
    SND_SOC_NTP8918 = no;
    SND_SOC_PCM1681 = no;
    SND_SOC_PCM1789_I2C = no;
    SND_SOC_PCM179X_I2C = no;
    SND_SOC_PCM179X_SPI = no;
    SND_SOC_PCM186X_I2C = no;
    SND_SOC_PCM186X_SPI = no;
    SND_SOC_PCM3060_I2C = no;
    SND_SOC_PCM3060_SPI = no;
    SND_SOC_PCM3168A_I2C = no;
    SND_SOC_PCM3168A_SPI = no;
    SND_SOC_PCM5102A = no;
    SND_SOC_PCM512x_I2C = no;
    SND_SOC_PCM512x_SPI = no;
    SND_SOC_PCM6240 = no;
    SND_SOC_PEB2466 = no;
    SND_SOC_RT1017_SDCA_SDW = no;
    SND_SOC_RT1308_SDW = no;
    SND_SOC_RT1316_SDW = no;
    SND_SOC_RT1318_SDW = no;
    SND_SOC_RT1320_SDW = no;
    SND_SOC_RT5616 = no;
    SND_SOC_RT5631 = no;
    SND_SOC_RT5640 = no;
    SND_SOC_RT5659 = no;
    SND_SOC_RT5682_SDW = no;
    SND_SOC_RT700_SDW = no;
    SND_SOC_RT711_SDCA_SDW = no;
    SND_SOC_RT711_SDW = no;
    SND_SOC_RT712_SDCA_DMIC_SDW = no;
    SND_SOC_RT712_SDCA_SDW = no;
    SND_SOC_RT715_SDCA_SDW = no;
    SND_SOC_RT715_SDW = no;
    SND_SOC_RT721_SDCA_SDW = no;
    SND_SOC_RT722_SDCA_SDW = no;
    SND_SOC_RT9120 = no;
    SND_SOC_RT9123 = no;
    SND_SOC_RT9123P = no;
    SND_SOC_RTQ9128 = no;
    SND_SOC_SDW_MOCKUP = no;
    SND_SOC_SGTL5000 = no;
    SND_SOC_SIMPLE_AMPLIFIER = no;
    SND_SOC_SIMPLE_MUX = no;
    SND_SOC_SMA1303 = no;
    SND_SOC_SMA1307 = no;
    SND_SOC_SOF_ACPI = no;
    SND_SOC_SOF_ALDERLAKE = no;
    SND_SOC_SOF_AMD_SOUNDWIRE = no;
    SND_SOC_SOF_APOLLOLAKE = no;
    SND_SOC_SOF_CANNONLAKE = no;
    SND_SOC_SOF_COFFEELAKE = no;
    SND_SOC_SOF_COMETLAKE = no;
    SND_SOC_SOF_ELKHARTLAKE = no;
    SND_SOC_SOF_GEMINILAKE = no;
    SND_SOC_SOF_ICELAKE = no;
    SND_SOC_SOF_JASPERLAKE = no;
    SND_SOC_SOF_KABYLAKE = no;
    SND_SOC_SOF_LUNARLAKE = no;
    SND_SOC_SOF_MERRIFIELD = no;
    SND_SOC_SOF_METEORLAKE = no;
    SND_SOC_SOF_OF = no;
    SND_SOC_SOF_PANTHERLAKE = no;
    SND_SOC_SOF_SKYLAKE = no;
    SND_SOC_SOF_TIGERLAKE = no;
    SND_SOC_SPDIF = no;
    SND_SOC_SRC4XXX_I2C = no;
    SND_SOC_SSM2305 = no;
    SND_SOC_SSM2518 = no;
    SND_SOC_SSM2602_I2C = no;
    SND_SOC_SSM2602_SPI = no;
    SND_SOC_SSM3515 = no;
    SND_SOC_SSM4567 = no;
    SND_SOC_STA32X = no;
    SND_SOC_STA350 = no;
    SND_SOC_STI_SAS = no;
    SND_SOC_TAS2552 = no;
    SND_SOC_TAS2562 = no;
    SND_SOC_TAS2764 = no;
    SND_SOC_TAS2770 = no;
    SND_SOC_TAS2780 = no;
    SND_SOC_TAS2781_I2C = no;
    SND_SOC_TAS5086 = no;
    SND_SOC_TAS571X = no;
    SND_SOC_TAS5720 = no;
    SND_SOC_TAS5805M = no;
    SND_SOC_TAS6424 = no;
    SND_SOC_TDA7419 = no;
    SND_SOC_TFA9879 = no;
    SND_SOC_TFA989X = no;
    SND_SOC_TLV320ADC3XXX = no;
    SND_SOC_TLV320ADCX140 = no;
    SND_SOC_TLV320AIC23_I2C = no;
    SND_SOC_TLV320AIC23_SPI = no;
    SND_SOC_TLV320AIC31XX = no;
    SND_SOC_TLV320AIC32X4_I2C = no;
    SND_SOC_TLV320AIC32X4_SPI = no;
    SND_SOC_TLV320AIC3X_I2C = no;
    SND_SOC_TLV320AIC3X_SPI = no;
    SND_SOC_TPA6130A2 = no;
    SND_SOC_TS3A227E = no;
    SND_SOC_TSCS42XX = no;
    SND_SOC_TSCS454 = no;
    SND_SOC_UDA1334 = no;
    SND_SOC_UDA1342 = no;
    SND_SOC_USB = no;
    SND_SOC_WCD937X_SDW = no;
    SND_SOC_WCD938X_SDW = no;
    SND_SOC_WCD939X_SDW = no;
    SND_SOC_WM8510 = no;
    SND_SOC_WM8523 = no;
    SND_SOC_WM8524 = no;
    SND_SOC_WM8580 = no;
    SND_SOC_WM8711 = no;
    SND_SOC_WM8728 = no;
    SND_SOC_WM8731_I2C = no;
    SND_SOC_WM8731_SPI = no;
    SND_SOC_WM8737 = no;
    SND_SOC_WM8741 = no;
    SND_SOC_WM8750 = no;
    SND_SOC_WM8753 = no;
    SND_SOC_WM8770 = no;
    SND_SOC_WM8776 = no;
    SND_SOC_WM8782 = no;
    SND_SOC_WM8804_I2C = no;
    SND_SOC_WM8804_SPI = no;
    SND_SOC_WM8903 = no;
    SND_SOC_WM8904 = no;
    SND_SOC_WM8940 = no;
    SND_SOC_WM8960 = no;
    SND_SOC_WM8961 = no;
    SND_SOC_WM8962 = no;
    SND_SOC_WM8974 = no;
    SND_SOC_WM8978 = no;
    SND_SOC_WM8985 = no;
    SND_SOC_WSA881X = no;
    SND_SOC_WSA883X = no;
    SND_SOC_WSA884X = no;
    SND_SOC_XILINX_AUDIO_FORMATTER = no;
    SND_SOC_XILINX_I2S = no;
    SND_SOC_XILINX_SPDIF = no;
    SND_SOC_XTFPGA_I2S = no;
    SND_SOC_ZL38060 = no;
    SND_SONICVIBES = no;
    SND_SST_ATOM_HIFI2_PLATFORM_PCI = no;
    SND_TEST_COMPONENT = no;
    SND_TRIDENT = no;
    SND_USB_6FIRE = no;
    SND_USB_CAIAQ = no;
    SND_USB_HIFACE = no;
    SND_USB_POD = no;
    SND_USB_PODHD = no;
    SND_USB_TONEPORT = no;
    SND_USB_VARIAX = no;
    SND_VIA82XX = no;
    SND_VIA82XX_MODEM = no;
    SND_VIRMIDI = no;
    SND_VIRTUOSO = no;
    SND_VX222 = no;
    SND_YMFPCI = no;

    SND_USB_CAIAQ_INPUT = unset;
    SND_AC97_POWER_SAVE = unset;
    SND_AC97_POWER_SAVE_DEFAULT = unset;
    SND_SOC_SOF_HDA_LINK = unset;
    SND_SOC_SOF_HDA_AUDIO_CODEC = unset;
    SND_SOC_INTEL_SOUNDWIRE_SOF_MACH = unset;
  };

  localmod-unused-video = {
    VIDEO_SOLO6X10 = unset;
    VIDEO_TW5864 = unset;
    VIDEO_TW68 = unset;
    VIDEO_TW686X = unset;
    VIDEO_ZORAN = unset;
    VIDEO_DT3155 = unset;
    VIDEO_IVTV = unset;
    VIDEO_HEXIUM_GEMINI = unset;
    VIDEO_HEXIUM_ORION = unset;
    VIDEO_MXB = unset;
    VIDEO_BT848 = unset;
    VIDEO_CX25821 = unset;
    VIDEO_CX88 = unset;
    VIDEO_SAA7134 = unset;
    VIDEO_IPU3_CIO2 = unset;
    VIDEO_INTEL_IPU6 = unset;
    VIDEO_CADENCE_CSI2RX = unset;
    VIDEO_CADENCE_CSI2TX = unset;
    VIDEO_RP1_CFE = unset;
    VIDEO_IR_I2C = no;
    VIDEO_ALVIUM_CSI2 = no;
    VIDEO_AR0521 = no;
    VIDEO_GC0308 = no;
    VIDEO_GC05A2 = no;
    VIDEO_GC08A3 = no;
    VIDEO_GC2145 = no;
    VIDEO_HI556 = no;
    VIDEO_HI846 = no;
    VIDEO_HI847 = no;
    VIDEO_IMX208 = no;
    VIDEO_IMX214 = no;
    VIDEO_IMX219 = no;
    VIDEO_IMX258 = no;
    VIDEO_IMX274 = no;
    VIDEO_IMX283 = no;
    VIDEO_IMX290 = no;
    VIDEO_IMX296 = no;
    VIDEO_IMX319 = no;
    VIDEO_IMX334 = no;
    VIDEO_IMX335 = no;
    VIDEO_IMX355 = no;
    VIDEO_IMX412 = no;
    VIDEO_IMX415 = no;
    VIDEO_MT9M001 = no;
    VIDEO_MT9M111 = no;
    VIDEO_MT9M114 = no;
    VIDEO_MT9P031 = no;
    VIDEO_MT9T112 = no;
    VIDEO_MT9V011 = no;
    VIDEO_MT9V032 = no;
    VIDEO_MT9V111 = no;
    VIDEO_OG01A1B = no;
    VIDEO_OV01A10 = no;
    VIDEO_OV02A10 = no;
    VIDEO_OV02E10 = no;
    VIDEO_OV02C10 = no;
    VIDEO_OV08D10 = no;
    VIDEO_OV08X40 = no;
    VIDEO_OV13858 = no;
    VIDEO_OV13B10 = no;
    VIDEO_OV2640 = no;
    VIDEO_OV2659 = no;
    VIDEO_OV2680 = no;
    VIDEO_OV2685 = no;
    VIDEO_OV2740 = no;
    VIDEO_OV4689 = no;
    VIDEO_OV5640 = no;
    VIDEO_OV5645 = no;
    VIDEO_OV5647 = no;
    VIDEO_OV5648 = no;
    VIDEO_OV5670 = no;
    VIDEO_OV5675 = no;
    VIDEO_OV5693 = no;
    VIDEO_OV5695 = no;
    VIDEO_OV64A40 = no;
    VIDEO_OV6650 = no;
    VIDEO_OV7251 = no;
    VIDEO_OV7640 = no;
    VIDEO_OV7670 = no;
    VIDEO_OV772X = no;
    VIDEO_OV7740 = no;
    VIDEO_OV8856 = no;
    VIDEO_OV8858 = no;
    VIDEO_OV8865 = no;
    VIDEO_OV9282 = no;
    VIDEO_OV9640 = no;
    VIDEO_OV9650 = no;
    VIDEO_OV9734 = no;
    VIDEO_RDACM20 = no;
    VIDEO_RDACM21 = no;
    VIDEO_RJ54N1 = no;
    VIDEO_S5C73M3 = no;
    VIDEO_S5K5BAF = no;
    VIDEO_S5K6A3 = no;
    VIDEO_VD55G1 = no;
    VIDEO_VD56G3 = no;
    VIDEO_VGXY61 = no;
    VIDEO_CCS = no;
    VIDEO_ET8EK8 = no;
    VIDEO_THP7312 = no;
    VIDEO_AD5820 = no;
    VIDEO_AK7375 = no;
    VIDEO_DW9714 = no;
    VIDEO_DW9719 = no;
    VIDEO_DW9768 = no;
    VIDEO_DW9807_VCM = no;
    VIDEO_ADP1653 = no;
    VIDEO_LM3560 = no;
    VIDEO_LM3646 = no;
    VIDEO_SONY_BTF_MPX = no;
    VIDEO_TDA1997X = no;
    VIDEO_TDA7432 = no;
    VIDEO_TDA9840 = no;
    VIDEO_TEA6415C = no;
    VIDEO_TEA6420 = no;
    VIDEO_TLV320AIC23B = no;
    VIDEO_TVAUDIO = no;
    VIDEO_UDA1342 = no;
    VIDEO_VP27SMPX = no;
    VIDEO_WM8739 = no;
    VIDEO_SAA6588 = no;
    VIDEO_ADV7180 = no;
    VIDEO_ADV7183 = no;
    VIDEO_ADV748X = no;
    VIDEO_ADV7604 = no;
    VIDEO_ADV7842 = no;
    VIDEO_BT819 = no;
    VIDEO_BT856 = no;
    VIDEO_BT866 = no;
    VIDEO_ISL7998X = no;
    VIDEO_LT6911UXE = no;
    VIDEO_KS0127 = no;
    VIDEO_ML86V7667 = no;
    VIDEO_SAA7110 = no;
    VIDEO_TC358743 = no;
    VIDEO_TC358746 = no;
    VIDEO_TVP514X = no;
    VIDEO_TVP5150 = no;
    VIDEO_TVP7002 = no;
    VIDEO_TW2804 = no;
    VIDEO_TW9900 = no;
    VIDEO_TW9903 = no;
    VIDEO_TW9906 = no;
    VIDEO_TW9910 = no;
    VIDEO_VPX3220 = no;
    VIDEO_SAA717X = no;
    VIDEO_ADV7170 = no;
    VIDEO_ADV7175 = no;
    VIDEO_ADV7343 = no;
    VIDEO_ADV7393 = no;
    VIDEO_AK881X = no;
    VIDEO_SAA7127 = no;
    VIDEO_SAA7185 = no;
    VIDEO_THS8200 = no;
    VIDEO_UPD64031A = no;
    VIDEO_UPD64083 = no;
    VIDEO_SAA6752HS = no;
    SDR_MAX2175 = no;
    VIDEO_I2C = no;
    VIDEO_M52790 = no;
    VIDEO_ST_MIPID02 = no;
    VIDEO_THS7303 = no;
    VIDEO_DS90UB913 = no;
    VIDEO_DS90UB953 = no;
    VIDEO_DS90UB960 = no;
    VIDEO_MAX96714 = no;
    VIDEO_MAX96717 = no;
    VIDEO_GS1662 = no;
    VIDEO_GO7007 = no;
    VIDEO_HDPVR = no;
    VIDEO_STK1160 = no;
    VIDEO_EM28XX = no;

    # cleanups
    VIDEO_ADV7511 = unset;
    VIDEO_CS3308 = module;
    VIDEO_CS5345 = module;
    VIDEO_CS53L32A = module;
    VIDEO_CX25840 = module;
    VIDEO_MSP3400 = module;
    VIDEO_SAA711X = module;
    VIDEO_WM8775 = module;

  };

  localmod-unused-wifi = {
    WLAN_VENDOR_ADMTEK = yes;
    WLAN_VENDOR_ATH = no;
    WLAN_VENDOR_ATMEL = no;
    WLAN_VENDOR_BROADCOM = no;
    WLAN_VENDOR_INTEL = yes;
    WLAN_VENDOR_INTERSIL = no;
    WLAN_VENDOR_MARVELL = no;
    WLAN_VENDOR_MEDIATEK = no;
    WLAN_VENDOR_MICROCHIP = no;
    WLAN_VENDOR_PURELIFI = no;
    WLAN_VENDOR_QUANTENNA = no;
    WLAN_VENDOR_RALINK = no;
    WLAN_VENDOR_REALTEK = no;
    WLAN_VENDOR_RSI = no;
    WLAN_VENDOR_SILABS = no;
    WLAN_VENDOR_ST = no;
    WLAN_VENDOR_TI = no;
    WLAN_VENDOR_ZYDAS = no;

    # fallout
    RT2800USB_RT53XX = unset;
    RT2800USB_RT55XX = unset;
    RTW88 = unset;
    RTW88_8822BE = unset;
    RTW88_8822CE = unset;
  };

  # Options I don't want turned off on some hardware
  g14 = {
    # ACPI_TINY_POWER_BUTTON = yes; # reports already set
    NR_CPUS = freeform "16";
    CPU_SUP_AMD = yes;
  };
}
